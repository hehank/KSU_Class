#! /usr/bin/env python3
# -*- coding: utf-8 -*-

alphabet = [chr(x) for x in range(97, 123)]
alphabet.append('_')

ciphertext = 'ifpmluglesecdlqp_rclfrseljpkq'
plaintext = ''

# ? p * 4 + 15 mod 27 = c

# Affine cipher
# ? E(x) = (4x + 15) mod 27

# ? D(x) = 4^-1(x - 15) mod 27

# ? 1 = 4 * 4^-1 mod 27

# ? D(E(x)) = 4^-1(E(x) - 15) mod 27
# ?         = 4^-1(((4x + 15) mod 27) - 15) mod 27
# ?         = 4^-1(4x + 15 - 15) mod 27
# ?         = 4^-1 * 4x mod 27
# ?         = x mod 27

for i in ciphertext:
    x = 4 ^ -1 * (alphabet.index(i) - 15) % 27
    plaintext += alphabet[x - 1]

print(plaintext)
